(()=>{var e={};e.id=931,e.ids=[931],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},3356:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>o,pages:()=>m,routeModule:()=>h,tree:()=>x});var a=t(3137),l=t(4647),r=t(4183),i=t.n(r),d=t(1775),c={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>d[e]);t.d(s,c);let n=a.AppPageRouteModule,x=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,4165)),"C:\\Users\\pc\\drive\\Bureau\\codes\\gitride\\app\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,9958)),"C:\\Users\\pc\\drive\\Bureau\\codes\\gitride\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,1918,23)),"next/dist/client/components/not-found-error"]}],m=["C:\\Users\\pc\\drive\\Bureau\\codes\\gitride\\app\\page.tsx"],o="/page",u={require:t,loadChunk:()=>Promise.resolve()},h=new n({definition:{kind:l.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:x}})},9213:(e,s,t)=>{Promise.resolve().then(t.bind(t,2468))},2468:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>ea});var a=t(80),l=t(6904),r=t(9885),i=t(8384),d=t(9424),c=t(3478),n=t(7052),x=t(999),m=t(8334),o=t(9490),u=t(3294),h=t(7631),p=t(3680),f=t(9941);function j(){let{signIn:e,signUp:s}=(0,l.a)(),[t,j]=(0,r.useState)(!1),[g,N]=(0,r.useState)(""),[v,b]=(0,r.useState)(""),[y,w]=(0,r.useState)(""),[_,k]=(0,r.useState)(""),[Z,F]=(0,r.useState)(""),[S,A]=(0,r.useState)("user"),q=async s=>{s.preventDefault(),j(!0);let{error:t}=await e(g,v);t?f.Am.error(t.message||"Failed to sign in"):f.Am.success("Welcome back!"),j(!1)},C=async e=>{e.preventDefault(),j(!0);let{error:t}=await s(y,_,Z,S);t?f.Am.error(t.message||"Failed to sign up"):f.Am.success("Account created successfully!"),j(!1)};return(0,a.jsxs)("div",{className:"w-full max-w-md mx-auto",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-[#fdb927] to-[#f59e0b] rounded-[22.5%] shadow-lg shadow-[#fdb927]/30 mb-4",children:a.jsx(m.Z,{className:"w-11 h-11 text-white"})}),a.jsx("h1",{className:"text-3xl font-bold text-gray-900 tracking-tight",children:"Ride App"}),a.jsx("p",{className:"text-[15px] text-gray-600 mt-1",children:"Your journey starts here"})]}),a.jsx(n.Zb,{className:"ios-card border-gray-200 bg-white overflow-hidden",children:a.jsx(n.aY,{className:"p-0",children:(0,a.jsxs)(x.mQ,{defaultValue:"login",className:"w-full",children:[a.jsx("div",{className:"p-4 bg-white border-b border-gray-200",children:a.jsx("div",{className:"ios-segment",children:(0,a.jsxs)(x.dr,{className:"w-full grid grid-cols-2 bg-transparent p-0 h-auto",children:[a.jsx(x.SP,{value:"login",className:"ios-segment-item data-[state=active]:ios-segment-item-active text-[15px]",children:"Sign In"}),a.jsx(x.SP,{value:"signup",className:"ios-segment-item data-[state=active]:ios-segment-item-active text-[15px]",children:"Sign Up"})]})})}),a.jsx(x.nU,{value:"login",className:"p-6 space-y-5 mt-0 bg-white",children:(0,a.jsxs)("form",{onSubmit:q,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(c._,{htmlFor:"login-email",className:"text-[15px] text-gray-700 font-normal",children:"Email"}),(0,a.jsxs)("div",{className:"relative",children:[a.jsx(o.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx(d.I,{id:"login-email",type:"email",placeholder:"you@example.com",value:g,onChange:e=>N(e.target.value),required:!0,className:"ios-input pl-11 text-[17px]",autoComplete:"email",disabled:t})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(c._,{htmlFor:"login-password",className:"text-[15px] text-gray-700 font-normal",children:"Password"}),(0,a.jsxs)("div",{className:"relative",children:[a.jsx(u.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx(d.I,{id:"login-password",type:"password",placeholder:"••••••••",value:v,onChange:e=>b(e.target.value),required:!0,className:"ios-input pl-11 text-[17px]",autoComplete:"current-password",disabled:t})]})]}),a.jsx(i.z,{type:"submit",disabled:t,className:"w-full ios-button-primary text-[17px] font-semibold mt-6",children:t?(0,a.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[a.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Signing in..."]}):(0,a.jsxs)("span",{className:"flex items-center justify-center gap-2",children:["Sign In",a.jsx(h.Z,{className:"w-5 h-5"})]})})]})}),a.jsx(x.nU,{value:"signup",className:"p-6 space-y-5 mt-0 bg-white",children:(0,a.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(c._,{htmlFor:"signup-name",className:"text-[15px] text-gray-700 font-normal",children:"Full Name"}),(0,a.jsxs)("div",{className:"relative",children:[a.jsx(p.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx(d.I,{id:"signup-name",type:"text",placeholder:"John Doe",value:Z,onChange:e=>F(e.target.value),required:!0,className:"ios-input pl-11 text-[17px]",autoComplete:"name",disabled:t})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(c._,{htmlFor:"signup-email",className:"text-[15px] text-gray-700 font-normal",children:"Email"}),(0,a.jsxs)("div",{className:"relative",children:[a.jsx(o.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx(d.I,{id:"signup-email",type:"email",placeholder:"you@example.com",value:y,onChange:e=>w(e.target.value),required:!0,className:"ios-input pl-11 text-[17px]",autoComplete:"email",disabled:t})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(c._,{htmlFor:"signup-password",className:"text-[15px] text-gray-700 font-normal",children:"Password"}),(0,a.jsxs)("div",{className:"relative",children:[a.jsx(u.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx(d.I,{id:"signup-password",type:"password",placeholder:"••••••••",value:_,onChange:e=>k(e.target.value),required:!0,minLength:6,className:"ios-input pl-11 text-[17px]",autoComplete:"new-password",disabled:t})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(c._,{className:"text-[15px] text-gray-700 font-normal",children:"Account Type"}),(0,a.jsxs)("div",{className:"ios-list rounded-lg overflow-hidden",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>A("user"),disabled:t,className:`ios-list-item w-full flex items-center justify-between ${"user"===S?"bg-gray-50":""}`,children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-9 h-9 rounded-full flex items-center justify-center ${"user"===S?"bg-[#007AFF]":"bg-gray-200"}`,children:a.jsx(p.Z,{className:`w-5 h-5 ${"user"===S?"text-white":"text-gray-600"}`})}),(0,a.jsxs)("div",{className:"text-left",children:[a.jsx("p",{className:"text-[17px] font-medium text-gray-900",children:"Rider"}),a.jsx("p",{className:"text-[13px] text-gray-500",children:"Book rides and travel"})]})]}),"user"===S&&a.jsx("div",{className:"w-6 h-6 rounded-full bg-[#007AFF] flex items-center justify-center",children:a.jsx("div",{className:"w-2 h-2 rounded-full bg-white"})})]}),(0,a.jsxs)("button",{type:"button",onClick:()=>A("driver"),disabled:t,className:`ios-list-item w-full flex items-center justify-between ${"driver"===S?"bg-gray-50":""}`,children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-9 h-9 rounded-full flex items-center justify-center ${"driver"===S?"bg-[#007AFF]":"bg-gray-200"}`,children:a.jsx(m.Z,{className:`w-5 h-5 ${"driver"===S?"text-white":"text-gray-600"}`})}),(0,a.jsxs)("div",{className:"text-left",children:[a.jsx("p",{className:"text-[17px] font-medium text-gray-900",children:"Driver"}),a.jsx("p",{className:"text-[13px] text-gray-500",children:"Drive and earn money"})]})]}),"driver"===S&&a.jsx("div",{className:"w-6 h-6 rounded-full bg-[#007AFF] flex items-center justify-center",children:a.jsx("div",{className:"w-2 h-2 rounded-full bg-white"})})]})]})]}),a.jsx(i.z,{type:"submit",disabled:t,className:"w-full ios-button-primary text-[17px] font-semibold mt-6",children:t?(0,a.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[a.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Creating account..."]}):(0,a.jsxs)("span",{className:"flex items-center justify-center gap-2",children:["Create Account",a.jsx(h.Z,{className:"w-5 h-5"})]})})]})})]})})}),a.jsx("div",{className:"text-center mt-6",children:a.jsx("p",{className:"text-[13px] text-gray-500",children:"Secure and encrypted connection"})})]})}var g=t(7988),N=t(4868),v=t(2410),b=t(5441),y=t(6583),w=t(6908),_=t(7094);function k(){let{user:e}=(0,l.a)(),[s,t]=(0,r.useState)(null),[d,c]=(0,r.useState)(null),[x,o]=(0,r.useState)(!1),[u,h]=(0,r.useState)(!1),[p,j]=(0,r.useState)(null),[k,Z]=(0,r.useState)(null),[F,S]=(0,r.useState)(null);(0,r.useEffect)(()=>{s&&d?A():(j(null),Z(null),S(null))},[s,d]);let A=async()=>{if(s&&d){h(!0);try{let e=(d.lat-s.lat)*Math.PI/180,t=(d.lng-s.lng)*Math.PI/180,a=Math.sin(e/2)*Math.sin(e/2)+Math.cos(s.lat*Math.PI/180)*Math.cos(d.lat*Math.PI/180)*Math.sin(t/2)*Math.sin(t/2),l=6371*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))),r=5+2.5*l,i=Math.round(l/40*60);S(l),j(r),Z(i)}catch(e){console.error("Error calculating estimate:",e),f.Am.error("Failed to calculate estimate")}finally{h(!1)}}},q=async()=>{if(!s||!d){f.Am.error("Please select both pickup and dropoff locations");return}if(!e){f.Am.error("Please sign in to book a ride");return}o(!0);try{let{data:a,error:l}=await g.O.from("rides").insert([{user_id:e.id,pickup_latitude:s.lat,pickup_longitude:s.lng,pickup_address:s.address||`${s.lat}, ${s.lng}`,dropoff_latitude:d.lat,dropoff_longitude:d.lng,dropoff_address:d.address||`${d.lat}, ${d.lng}`,fare_amount:p,status:"requested"}]).select().single();if(l)throw l;f.Am.success("Ride requested!",{description:"Finding a driver nearby..."}),t(null),c(null),j(null),Z(null),S(null)}catch(e){console.error(e),f.Am.error("Failed to book ride",{description:"Please try again"})}finally{o(!1)}};return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)(n.Zb,{className:"ios-card overflow-hidden",children:[a.jsx(n.Ol,{className:"pb-4 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx(n.ll,{className:"text-xl font-semibold text-gray-900",children:"Book a Ride"}),a.jsx(n.SZ,{className:"text-[15px] text-gray-600 mt-0.5",children:"Where would you like to go?"})]}),p&&(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-[#007AFF]",children:["$",p.toFixed(2)]}),k&&(0,a.jsxs)("div",{className:"text-[13px] text-gray-500 flex items-center gap-1 justify-end",children:[a.jsx(b.Z,{className:"w-3.5 h-3.5"}),k," min"]})]})]})}),(0,a.jsxs)(n.aY,{className:"space-y-6 p-4",children:[a.jsx("div",{children:a.jsx(N._,{onLocationSelect:t,label:"Pickup Location",placeholder:"Where should we pick you up?",initialLocation:s||void 0})}),a.jsx("div",{children:a.jsx(N._,{onLocationSelect:c,label:"Destination",placeholder:"Where are you going?",initialLocation:d||void 0})}),s&&d&&(0,a.jsxs)("div",{className:"border-t pt-4",children:[(0,a.jsxs)("h3",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center gap-2",children:[a.jsx(y.Z,{className:"w-4 h-4"}),"Your Route"]}),a.jsx(v.P,{pickup:s,destination:d,showDetails:!1})]}),p&&!u&&a.jsx("div",{className:"p-4 rounded-lg bg-blue-50 border border-blue-200",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-[13px] text-gray-600 mb-1",children:"Estimated Fare"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-[#007AFF]",children:["$",p.toFixed(2)]})]}),k&&(0,a.jsxs)("div",{className:"text-right",children:[a.jsx("p",{className:"text-[13px] text-gray-600 mb-1",children:"Duration"}),(0,a.jsxs)("p",{className:"text-lg font-semibold text-gray-900 flex items-center gap-1",children:[a.jsx(b.Z,{className:"w-4 h-4"}),k," min"]})]})]}),F&&a.jsx("div",{className:"pt-2 border-t border-blue-300",children:(0,a.jsxs)("p",{className:"text-[13px] text-gray-600",children:["Distance: ",F.toFixed(2)," km"]})})]})}),a.jsx(i.z,{onClick:q,disabled:x||u||!s||!d,className:"w-full ios-button-primary text-[17px] h-12",children:x?(0,a.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[a.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Booking..."]}):(0,a.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[a.jsx(m.Z,{className:"w-5 h-5"}),p?`Book Ride - $${p.toFixed(2)}`:"Select Locations to Book"]})})]})]}),(0,a.jsxs)("div",{className:"ios-list",children:[(0,a.jsxs)("div",{className:"ios-list-item flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-green-100 flex items-center justify-center flex-shrink-0",children:a.jsx(b.Z,{className:"w-5 h-5 text-green-600"})}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("p",{className:"text-[17px] font-medium text-gray-900",children:"Fast Pickup"}),a.jsx("p",{className:"text-[13px] text-gray-500",children:"Average wait: 3-5 minutes"})]})]}),(0,a.jsxs)("div",{className:"ios-list-item flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0",children:a.jsx(w.Z,{className:"w-5 h-5 text-blue-600"})}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("p",{className:"text-[17px] font-medium text-gray-900",children:"Transparent Pricing"}),a.jsx("p",{className:"text-[13px] text-gray-500",children:"No hidden fees or surge pricing"})]})]}),(0,a.jsxs)("div",{className:"ios-list-item flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center flex-shrink-0",children:a.jsx(_.Z,{className:"w-5 h-5 text-purple-600"})}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("p",{className:"text-[17px] font-medium text-gray-900",children:"Accurate Locations"}),a.jsx("p",{className:"text-[13px] text-gray-500",children:"Powered by Mapbox with real-time search"})]})]})]})]})}var Z=t(4796),F=t(7932),S=t(6206);function A(){let{user:e}=(0,l.a)(),[s,t]=(0,r.useState)([]),[d,c]=(0,r.useState)(!0);(0,r.useEffect)(()=>{x();let s=g.O.channel("active_rides").on("postgres_changes",{event:"*",schema:"public",table:"rides",filter:`user_id=eq.${e?.id}`},()=>{x()}).subscribe();return()=>{s.unsubscribe()}},[e?.id]);let x=async()=>{if(!e)return;let{data:s,error:a}=await g.O.from("rides").select("*, driver:profiles!rides_driver_id_fkey(*)").eq("user_id",e.id).in("status",["requested","accepted","in_progress"]).order("created_at",{ascending:!1});s&&t(s),c(!1)},m=async e=>{let{error:s}=await g.O.from("rides").update({status:"cancelled"}).eq("id",e);s?f.Am.error("Failed to cancel ride"):f.Am.success("Ride cancelled")},o=e=>{switch(e){case"requested":return"bg-yellow-100 text-yellow-700 border-yellow-200";case"accepted":return"bg-blue-100 text-blue-700 border-blue-200";case"in_progress":return"bg-green-100 text-green-700 border-green-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}},u=e=>{switch(e){case"requested":return"Finding Driver";case"accepted":return"Driver En Route";case"in_progress":return"In Progress";default:return e}};return d?a.jsx(n.Zb,{className:"ios-card",children:a.jsx(n.aY,{className:"p-8 text-center",children:a.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-[#007AFF] border-t-transparent rounded-full mx-auto"})})}):0===s.length?a.jsx(n.Zb,{className:"ios-card",children:(0,a.jsxs)(n.Ol,{children:[a.jsx(n.ll,{className:"text-gray-900",children:"Active Rides"}),a.jsx(n.SZ,{className:"text-gray-600",children:"No active rides at the moment"})]})}):a.jsx("div",{className:"space-y-4",children:s.map(e=>(0,a.jsxs)(n.Zb,{className:"ios-card",children:[a.jsx(n.Ol,{className:"border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(n.ll,{className:"text-lg font-semibold text-gray-900",children:["Ride #",e.id.slice(0,8)]}),(0,a.jsxs)(n.SZ,{className:"flex items-center gap-2 mt-1 text-gray-600",children:[a.jsx(b.Z,{className:"w-3.5 h-3.5"}),new Date(e.requested_at).toLocaleTimeString()]})]}),a.jsx(Z.C,{className:`${o(e.status)} text-[13px] px-2 py-1 rounded-md font-medium border`,children:u(e.status)})]})}),(0,a.jsxs)(n.aY,{className:"space-y-4 p-4",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 flex items-center justify-center flex-shrink-0 mt-0.5",children:a.jsx(_.Z,{className:"w-4 h-4 text-green-600"})}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("p",{className:"text-[15px] font-medium text-gray-900",children:"Pickup"}),a.jsx("p",{className:"text-[13px] text-gray-600 mt-0.5",children:e.pickup_address||`${e.pickup_latitude.toFixed(4)}, ${e.pickup_longitude.toFixed(4)}`})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0 mt-0.5",children:a.jsx(_.Z,{className:"w-4 h-4 text-blue-600"})}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("p",{className:"text-[15px] font-medium text-gray-900",children:"Destination"}),a.jsx("p",{className:"text-[13px] text-gray-600 mt-0.5",children:e.dropoff_address||`${e.dropoff_latitude.toFixed(4)}, ${e.dropoff_longitude.toFixed(4)}`})]})]})]}),e.driver&&(0,a.jsxs)("div",{className:"p-3 rounded-lg bg-gray-50 flex items-center gap-3 border border-gray-200",children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden",children:e.driver.avatar_url?a.jsx("img",{src:e.driver.avatar_url,alt:e.driver.full_name,className:"w-full h-full object-cover"}):a.jsx(p.Z,{className:"w-6 h-6 text-gray-500"})}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium text-gray-900 text-[17px]",children:e.driver.full_name}),(0,a.jsxs)("div",{className:"flex items-center gap-1 mt-0.5",children:[a.jsx(F.Z,{className:"w-3.5 h-3.5 fill-yellow-500 text-yellow-500"}),a.jsx("span",{className:"text-[13px] text-gray-600",children:e.driver.rating.toFixed(1)})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-3 border-t border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center",children:a.jsx(w.Z,{className:"w-4 h-4 text-blue-600"})}),(0,a.jsxs)("span",{className:"font-semibold text-gray-900 text-lg",children:["$",e.fare_amount?.toFixed(2)]})]}),"requested"===e.status&&(0,a.jsxs)(i.z,{variant:"destructive",size:"sm",onClick:()=>m(e.id),className:"bg-red-600 hover:bg-red-700 text-white rounded-lg text-[15px] h-9 px-4",children:[a.jsx(S.Z,{className:"w-4 h-4 mr-1"}),"Cancel"]})]})]})]},e.id))})}var q=t(517);function C(){let{user:e}=(0,l.a)(),[s,t]=(0,r.useState)([]),[i,d]=(0,r.useState)(!0);(0,r.useEffect)(()=>{c()},[e?.id]);let c=async()=>{if(!e)return;let{data:s,error:a}=await g.O.from("rides").select("*, driver:profiles!rides_driver_id_fkey(*)").eq("user_id",e.id).in("status",["completed","cancelled"]).order("created_at",{ascending:!1}).limit(10);s&&t(s),d(!1)};return i?a.jsx(n.Zb,{className:"ios-card",children:a.jsx(n.aY,{className:"p-8 text-center",children:a.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-[#007AFF] border-t-transparent rounded-full mx-auto"})})}):0===s.length?a.jsx(n.Zb,{className:"ios-card",children:(0,a.jsxs)(n.Ol,{children:[a.jsx(n.ll,{className:"text-gray-900",children:"Ride History"}),a.jsx(n.SZ,{className:"text-gray-600 text-[15px]",children:"No completed rides yet"})]})}):(0,a.jsxs)(n.Zb,{className:"ios-card",children:[(0,a.jsxs)(n.Ol,{className:"border-b border-gray-200",children:[a.jsx(n.ll,{className:"text-gray-900 text-xl font-semibold",children:"Ride History"}),a.jsx(n.SZ,{className:"text-gray-600 text-[15px]",children:"Your recent trips"})]}),a.jsx(n.aY,{className:"p-0",children:a.jsx("div",{className:"divide-y divide-gray-200",children:s.map(e=>(0,a.jsxs)("div",{className:"p-4 bg-white hover:bg-gray-50 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-9 h-9 rounded-full bg-gray-100 flex items-center justify-center",children:a.jsx(q.Z,{className:"w-4 h-4 text-gray-600"})}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-medium text-gray-900 text-[17px]",children:new Date(e.completed_at||e.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),a.jsx("p",{className:"text-[13px] text-gray-500",children:new Date(e.completed_at||e.created_at).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})})]})]}),a.jsx(Z.C,{className:`text-[13px] px-2 py-1 rounded-md font-medium border ${"completed"===e.status?"bg-green-100 text-green-700 border-green-200":"bg-gray-100 text-gray-700 border-gray-200"}`,children:e.status})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-6 h-6 rounded-full bg-green-100 flex items-center justify-center flex-shrink-0 mt-0.5",children:a.jsx(_.Z,{className:"w-3.5 h-3.5 text-green-600"})}),a.jsx("span",{className:"text-[15px] text-gray-700 line-clamp-1",children:e.pickup_address||"Pickup location"})]}),(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0 mt-0.5",children:a.jsx(_.Z,{className:"w-3.5 h-3.5 text-blue-600"})}),a.jsx("span",{className:"text-[15px] text-gray-700 line-clamp-1",children:e.dropoff_address||"Drop-off location"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center",children:a.jsx(w.Z,{className:"w-4 h-4 text-blue-600"})}),(0,a.jsxs)("span",{className:"font-semibold text-gray-900 text-lg",children:["$",e.fare_amount?.toFixed(2)]})]}),e.driver&&"completed"===e.status&&(0,a.jsxs)("div",{className:"flex items-center gap-1 px-2 py-1 rounded-full bg-yellow-50",children:[a.jsx(F.Z,{className:"w-4 h-4 fill-yellow-500 text-yellow-500"}),a.jsx("span",{className:"text-[15px] font-medium text-gray-900",children:e.driver_rating||"Not rated"})]})]})]},e.id))})})]})}var P=t(1922),R=t(92);function D(){let{profile:e,signOut:s}=(0,l.a)();return(0,a.jsxs)("div",{className:"min-h-screen bg-[#F2F2F7] pb-20",children:[a.jsx("div",{className:"ios-navbar",children:a.jsx("div",{className:"container mx-auto px-4 max-w-6xl",children:a.jsx("div",{className:"flex items-center justify-between h-14",children:a.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Ride App"})})})}),(0,a.jsxs)("div",{className:"container mx-auto p-4 max-w-6xl space-y-4",children:[(0,a.jsxs)("div",{className:"ios-list rounded-xl overflow-hidden",children:[a.jsx("div",{className:"bg-white px-4 py-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-200 flex items-center justify-center flex-shrink-0 overflow-hidden",children:e?.avatar_url?a.jsx("img",{src:e.avatar_url,alt:e.full_name,className:"w-full h-full object-cover"}):a.jsx(p.Z,{className:"w-8 h-8 text-gray-500"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 truncate",children:e?.full_name||"User"}),(0,a.jsxs)("div",{className:"flex items-center gap-3 mt-0.5",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1 text-sm text-gray-600",children:[a.jsx(F.Z,{className:"w-4 h-4 fill-yellow-500 text-yellow-500"}),e?.rating?e.rating.toFixed(1):"0.0"]}),a.jsx("span",{className:"text-gray-300",children:"•"}),(0,a.jsxs)("span",{className:"flex items-center gap-1 text-sm text-gray-600",children:[a.jsx(_.Z,{className:"w-4 h-4"}),e?.total_rides||0," rides"]})]})]}),a.jsx(P.Z,{className:"w-5 h-5 text-gray-400 flex-shrink-0"})]})}),a.jsx("div",{className:"ios-separator mx-4"}),(0,a.jsxs)("button",{onClick:s,className:"ios-list-item w-full flex items-center justify-between text-left",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-7 h-7 rounded-full bg-red-100 flex items-center justify-center",children:a.jsx(R.Z,{className:"w-4 h-4 text-red-600"})}),a.jsx("span",{className:"text-[17px] text-red-600 font-normal",children:"Sign Out"})]}),a.jsx(P.Z,{className:"w-5 h-5 text-gray-400"})]})]}),(0,a.jsxs)(x.mQ,{defaultValue:"book",className:"space-y-4",children:[a.jsx("div",{className:"ios-segment",children:(0,a.jsxs)(x.dr,{className:"w-full grid grid-cols-3 bg-transparent p-0 h-auto",children:[a.jsx(x.SP,{value:"book",className:"ios-segment-item data-[state=active]:ios-segment-item-active text-[15px]",children:"Book Ride"}),a.jsx(x.SP,{value:"active",className:"ios-segment-item data-[state=active]:ios-segment-item-active text-[15px]",children:"Active"}),a.jsx(x.SP,{value:"history",className:"ios-segment-item data-[state=active]:ios-segment-item-active text-[15px]",children:"History"})]})}),a.jsx(x.nU,{value:"book",className:"mt-4 space-y-4",children:a.jsx(k,{})}),a.jsx(x.nU,{value:"active",className:"mt-4",children:a.jsx(A,{})}),a.jsx(x.nU,{value:"history",className:"mt-4",children:a.jsx(C,{})})]})]})]})}var $=t(2374),O=t(3161);let Y=r.forwardRef(({className:e,...s},t)=>a.jsx($.fC,{className:(0,O.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...s,ref:t,children:a.jsx($.bU,{className:(0,O.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Y.displayName=$.fC.displayName;var M=t(1264);function E(){let{user:e}=(0,l.a)(),[s,t]=(0,r.useState)([]),[d,c]=(0,r.useState)(!0);(0,r.useEffect)(()=>{x();let e=g.O.channel("available_rides").on("postgres_changes",{event:"*",schema:"public",table:"rides",filter:"status=eq.requested"},()=>{x()}).subscribe();return()=>{e.unsubscribe()}},[]);let x=async()=>{let{data:e,error:s}=await g.O.from("rides").select("*, user:profiles!rides_user_id_fkey(*)").eq("status","requested").is("driver_id",null).order("created_at",{ascending:!1});e&&t(e),c(!1)},m=async s=>{let{error:t}=await g.O.from("rides").update({driver_id:e?.id,status:"accepted",accepted_at:new Date().toISOString()}).eq("id",s);t?f.Am.error("Failed to accept ride"):f.Am.success("Ride accepted! Heading to pickup location...")},o=(e,s,t,a)=>(111*Math.sqrt(Math.pow(t-e,2)+Math.pow(a-s,2))).toFixed(1);return d?a.jsx(n.Zb,{className:"glass dark:glass-dark",children:a.jsx(n.aY,{className:"p-8 text-center",children:a.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto"})})}):0===s.length?(0,a.jsxs)(n.Zb,{className:"glass dark:glass-dark",children:[(0,a.jsxs)(n.Ol,{children:[a.jsx(n.ll,{children:"Available Rides"}),a.jsx(n.SZ,{children:"No ride requests at the moment"})]}),(0,a.jsxs)(n.aY,{className:"text-center py-8",children:[a.jsx("div",{className:"text-6xl mb-4 animate-pulse-glow",children:"\uD83D\uDE97"}),a.jsx("p",{className:"text-muted-foreground",children:"Waiting for ride requests..."})]})]}):(0,a.jsxs)(n.Zb,{className:"glass dark:glass-dark",children:[(0,a.jsxs)(n.Ol,{children:[(0,a.jsxs)(n.ll,{className:"flex items-center justify-between",children:["Available Rides",(0,a.jsxs)(Z.C,{className:"bg-green-500/10 text-green-500",children:[s.length," requests"]})]}),a.jsx(n.SZ,{children:"Accept rides and start earning"})]}),a.jsx(n.aY,{className:"space-y-4",children:s.map(e=>(0,a.jsxs)("div",{className:"p-4 rounded-lg border bg-card/50 hover:bg-card transition-all hover:shadow-lg",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-medium",children:e.user?.full_name}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[a.jsx(b.Z,{className:"w-3 h-3"}),new Date(e.requested_at).toLocaleTimeString()]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"font-bold text-lg text-primary",children:["$",e.fare_amount?.toFixed(2)]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[o(e.pickup_latitude,e.pickup_longitude,e.dropoff_latitude,e.dropoff_longitude)," km"]})]})]}),(0,a.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[a.jsx(_.Z,{className:"w-4 h-4 mt-0.5 text-green-500"}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium",children:"Pickup"}),a.jsx("p",{className:"text-sm text-muted-foreground line-clamp-1",children:e.pickup_address||`${e.pickup_latitude.toFixed(4)}, ${e.pickup_longitude.toFixed(4)}`})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[a.jsx(_.Z,{className:"w-4 h-4 mt-0.5 text-red-500"}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium",children:"Destination"}),a.jsx("p",{className:"text-sm text-muted-foreground line-clamp-1",children:e.dropoff_address||`${e.dropoff_latitude.toFixed(4)}, ${e.dropoff_longitude.toFixed(4)}`})]})]})]}),(0,a.jsxs)(i.z,{onClick:()=>m(e.id),className:"w-full",children:[a.jsx(M.Z,{className:"w-4 h-4 mr-2"}),"Accept Ride"]})]},e.id))})]})}var z=t(3020),U=t(6253),I=t(6980);let L=I.fC;I.xz;let T=I.h_;I.x8;let B=r.forwardRef(({className:e,...s},t)=>a.jsx(I.aV,{ref:t,className:(0,O.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...s}));B.displayName=I.aV.displayName;let H=r.forwardRef(({className:e,children:s,...t},l)=>(0,a.jsxs)(T,{children:[a.jsx(B,{}),(0,a.jsxs)(I.VY,{ref:l,className:(0,O.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t,children:[s,(0,a.jsxs)(I.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[a.jsx(S.Z,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));H.displayName=I.VY.displayName;let V=({className:e,...s})=>a.jsx("div",{className:(0,O.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...s});V.displayName="DialogHeader";let G=r.forwardRef(({className:e,...s},t)=>a.jsx(I.Dx,{ref:t,className:(0,O.cn)("text-lg font-semibold leading-none tracking-tight",e),...s}));G.displayName=I.Dx.displayName;let W=r.forwardRef(({className:e,...s},t)=>a.jsx(I.dk,{ref:t,className:(0,O.cn)("text-sm text-muted-foreground",e),...s}));function Q(){let{user:e}=(0,l.a)(),[s,t]=(0,r.useState)(null),[d,c]=(0,r.useState)(!0),[x,m]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if(!e?.id)return;o();let s=g.O.channel("driver_active_ride").on("postgres_changes",{event:"*",schema:"public",table:"rides",filter:`driver_id=eq.${e?.id}`},()=>{o()}).subscribe();return()=>{s.unsubscribe()}},[e?.id]);let o=async()=>{if(!e)return;let{data:s,error:a}=await g.O.from("rides").select("*, user:profiles!rides_user_id_fkey(*)").eq("driver_id",e.id).in("status",["accepted","in_progress"]).order("accepted_at",{ascending:!1}).limit(1).maybeSingle();s&&t(s),c(!1)},u=async()=>{if(!s)return;let{error:e}=await g.O.from("rides").update({status:"in_progress",started_at:new Date().toISOString()}).eq("id",s.id);e?f.Am.error("Failed to start ride"):f.Am.success("Ride started!")},h=async()=>{if(!s)return;let{error:e}=await g.O.from("rides").update({status:"completed",completed_at:new Date().toISOString(),payment_status:"completed"}).eq("id",s.id);e?f.Am.error("Failed to complete ride"):(f.Am.success("Ride completed!"),m(!1),t(null))};return d?a.jsx(n.Zb,{className:"glass dark:glass-dark",children:a.jsx(n.aY,{className:"p-8 text-center",children:a.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto"})})}):s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)(n.Zb,{className:"glass dark:glass-dark",children:[a.jsx(n.Ol,{children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx(n.ll,{children:"Current Ride"}),(0,a.jsxs)(n.SZ,{children:["Ride #",s.id.slice(0,8)]})]}),a.jsx(Z.C,{className:"accepted"===s.status?"bg-blue-500/10 text-blue-500":"bg-green-500/10 text-green-500",children:"accepted"===s.status?"En Route":"In Progress"})]})}),(0,a.jsxs)(n.aY,{className:"space-y-4",children:[a.jsx("div",{className:"p-4 rounded-lg bg-muted/50",children:(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/20 flex items-center justify-center",children:s.user?.avatar_url?a.jsx("img",{src:s.user.avatar_url,alt:s.user?.full_name||"User",className:"w-full h-full rounded-full"}):a.jsx("span",{className:"text-lg font-bold",children:s.user?.full_name?.[0]||"?"})}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-medium",children:s.user?.full_name}),(0,a.jsxs)("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[a.jsx(F.Z,{className:"w-3 h-3 fill-yellow-500 text-yellow-500"}),s.user?.rating?.toFixed(1)||"N/A"]})]})]})}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[a.jsx(_.Z,{className:"w-5 h-5 mt-0.5 text-green-500"}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium",children:"Pickup"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:s.pickup_address||`${s.pickup_latitude.toFixed(4)}, ${s.pickup_longitude.toFixed(4)}`})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[a.jsx(_.Z,{className:"w-5 h-5 mt-0.5 text-red-500"}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium",children:"Destination"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:s.dropoff_address||`${s.dropoff_latitude.toFixed(4)}, ${s.dropoff_longitude.toFixed(4)}`})]})]})]}),(0,a.jsxs)("div",{className:"pt-4 border-t",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("span",{className:"text-sm text-muted-foreground",children:"Fare Amount"}),(0,a.jsxs)("span",{className:"text-2xl font-bold text-primary",children:["$",s.fare_amount?.toFixed(2)]})]}),"accepted"===s.status?(0,a.jsxs)(i.z,{onClick:u,className:"w-full",size:"lg",children:[a.jsx(y.Z,{className:"w-4 h-4 mr-2"}),"Start Ride"]}):(0,a.jsxs)(i.z,{onClick:()=>m(!0),className:"w-full",size:"lg",children:[a.jsx(U.Z,{className:"w-4 h-4 mr-2"}),"Complete Ride"]})]})]})]}),a.jsx(n.Zb,{className:"glass dark:glass-dark overflow-hidden",children:a.jsx(n.aY,{className:"p-0",children:a.jsx(z.G,{className:"h-[400px] rounded-lg",showDirections:!0,origin:{lat:s.pickup_latitude,lng:s.pickup_longitude},destination:{lat:s.dropoff_latitude,lng:s.dropoff_longitude},markers:[{lat:s.pickup_latitude,lng:s.pickup_longitude,label:"A",title:s.pickup_address||"Pickup"},{lat:s.dropoff_latitude,lng:s.dropoff_longitude,label:"B",title:s.dropoff_address||"Destination"}]})})})]}),a.jsx(L,{open:x,onOpenChange:m,children:(0,a.jsxs)(H,{children:[(0,a.jsxs)(V,{children:[a.jsx(G,{children:"Complete Ride"}),a.jsx(W,{children:"Mark this ride as completed and collect payment"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[a.jsx("div",{className:"p-4 rounded-lg bg-muted",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm",children:"Total Fare"}),(0,a.jsxs)("span",{className:"text-2xl font-bold",children:["$",s.fare_amount?.toFixed(2)]})]})}),a.jsx(i.z,{onClick:h,className:"w-full",size:"lg",children:"Confirm & Complete"})]})]})})]}):(0,a.jsxs)(n.Zb,{className:"glass dark:glass-dark",children:[(0,a.jsxs)(n.Ol,{children:[a.jsx(n.ll,{children:"Active Ride"}),a.jsx(n.SZ,{children:"No active ride at the moment"})]}),(0,a.jsxs)(n.aY,{className:"text-center py-8",children:[a.jsx("div",{className:"text-6xl mb-4",children:"\uD83C\uDFAF"}),a.jsx("p",{className:"text-muted-foreground",children:"Accept a ride to get started"})]})]})}W.displayName=I.dk.displayName;var J=t(7);function X(){let{user:e}=(0,l.a)(),[s,t]=(0,r.useState)({totalEarnings:0,totalRides:0,avgRating:0,totalHours:0});(0,r.useEffect)(()=>{i()},[e?.id]);let i=async()=>{if(!e?.id)return;let{data:s}=await g.O.from("rides").select("fare_amount, driver_rating, duration_minutes").eq("driver_id",e.id).eq("status","completed");if(s){let e=s.reduce((e,s)=>e+(s.fare_amount||0),0),a=s.length,l=s.filter(e=>e.driver_rating),r=l.length>0?l.reduce((e,s)=>e+(s.driver_rating||0),0)/l.length:0,i=s.reduce((e,s)=>e+(s.duration_minutes||0),0);t({totalEarnings:e,totalRides:a,avgRating:r,totalHours:Math.round(i/60)})}};return(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,a.jsxs)(n.Zb,{className:"ios-card",children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-3",children:[a.jsx(n.ll,{className:"text-[15px] font-medium text-gray-700",children:"Total Earnings"}),a.jsx("div",{className:"w-10 h-10 rounded-full bg-green-100 flex items-center justify-center",children:a.jsx(w.Z,{className:"h-5 w-5 text-green-600"})})]}),(0,a.jsxs)(n.aY,{children:[(0,a.jsxs)("div",{className:"text-3xl font-bold text-gray-900",children:["$",s.totalEarnings.toFixed(2)]}),a.jsx("p",{className:"text-[13px] text-gray-500 mt-1",children:"From completed rides"})]})]}),(0,a.jsxs)(n.Zb,{className:"ios-card",children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-3",children:[a.jsx(n.ll,{className:"text-[15px] font-medium text-gray-700",children:"Total Rides"}),a.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:a.jsx(J.Z,{className:"h-5 w-5 text-blue-600"})})]}),(0,a.jsxs)(n.aY,{children:[a.jsx("div",{className:"text-3xl font-bold text-gray-900",children:s.totalRides}),a.jsx("p",{className:"text-[13px] text-gray-500 mt-1",children:"Completed successfully"})]})]}),(0,a.jsxs)(n.Zb,{className:"ios-card",children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-3",children:[a.jsx(n.ll,{className:"text-[15px] font-medium text-gray-700",children:"Average Rating"}),a.jsx("div",{className:"w-10 h-10 rounded-full bg-yellow-100 flex items-center justify-center",children:a.jsx(F.Z,{className:"h-5 w-5 text-yellow-500 fill-yellow-500"})})]}),(0,a.jsxs)(n.aY,{children:[a.jsx("div",{className:"text-3xl font-bold text-gray-900",children:s.avgRating.toFixed(1)}),a.jsx("p",{className:"text-[13px] text-gray-500 mt-1",children:"From passenger reviews"})]})]}),(0,a.jsxs)(n.Zb,{className:"ios-card",children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-3",children:[a.jsx(n.ll,{className:"text-[15px] font-medium text-gray-700",children:"Hours Driven"}),a.jsx("div",{className:"w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center",children:a.jsx(b.Z,{className:"h-5 w-5 text-purple-600"})})]}),(0,a.jsxs)(n.aY,{children:[(0,a.jsxs)("div",{className:"text-3xl font-bold text-gray-900",children:[s.totalHours,"h"]}),a.jsx("p",{className:"text-[13px] text-gray-500 mt-1",children:"Total time on road"})]})]})]})}function K(){let{profile:e,signOut:s,user:t}=(0,l.a)(),[i,d]=(0,r.useState)(null),[c,o]=(0,r.useState)(!1);(0,r.useEffect)(()=>{u()},[t?.id]);let u=async()=>{if(!t?.id)return;let{data:e,error:s}=await g.O.from("driver_profiles").select("*").eq("id",t.id).maybeSingle();if(e)d(e),o(e.is_available);else if(!e&&!s){let{error:e}=await g.O.from("driver_profiles").insert([{id:t.id,vehicle_type:"standard",is_available:!1}]);e||u()}},h=async e=>{if(!t?.id)return;let{error:s}=await g.O.from("driver_profiles").update({is_available:e}).eq("id",t.id);s?f.Am.error("Failed to update availability"):(o(e),f.Am.success(e?"You are now available":"You are now offline"))};return(0,a.jsxs)("div",{className:"min-h-screen bg-[#F2F2F7] pb-20",children:[a.jsx("div",{className:"ios-navbar",children:a.jsx("div",{className:"container mx-auto px-4 max-w-6xl",children:a.jsx("div",{className:"flex items-center justify-between h-14",children:a.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Driver"})})})}),(0,a.jsxs)("div",{className:"container mx-auto p-4 max-w-6xl space-y-4",children:[(0,a.jsxs)("div",{className:"ios-list rounded-xl overflow-hidden",children:[a.jsx("div",{className:"bg-white px-4 py-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-200 flex items-center justify-center flex-shrink-0 overflow-hidden",children:e?.avatar_url?a.jsx("img",{src:e.avatar_url,alt:e.full_name,className:"w-full h-full object-cover"}):a.jsx(m.Z,{className:"w-8 h-8 text-gray-500"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 truncate",children:e?.full_name||"Driver"}),a.jsx("span",{className:"text-xs font-medium px-2 py-0.5 rounded-full bg-blue-100 text-blue-700",children:"Driver"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 mt-0.5",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1 text-sm text-gray-600",children:[a.jsx(F.Z,{className:"w-4 h-4 fill-yellow-500 text-yellow-500"}),e?.rating?e.rating.toFixed(1):"0.0"]}),a.jsx("span",{className:"text-gray-300",children:"•"}),(0,a.jsxs)("span",{className:"flex items-center gap-1 text-sm text-gray-600",children:[a.jsx(w.Z,{className:"w-4 h-4"}),e?.total_rides||0," rides"]})]})]}),a.jsx(P.Z,{className:"w-5 h-5 text-gray-400 flex-shrink-0"})]})}),a.jsx("div",{className:"ios-separator mx-4"}),(0,a.jsxs)("div",{className:"ios-list-item flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-7 h-7 rounded-full flex items-center justify-center ${c?"bg-green-100":"bg-gray-100"}`,children:a.jsx(m.Z,{className:`w-4 h-4 ${c?"text-green-600":"text-gray-500"}`})}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-[17px] font-medium text-gray-900",children:c?"Available for Rides":"Currently Offline"}),a.jsx("p",{className:"text-[13px] text-gray-500",children:c?"You can accept rides":"Turn on to start earning"})]})]}),a.jsx(Y,{id:"availability",checked:c,onCheckedChange:h,className:"data-[state=checked]:bg-[#34C759]"})]}),a.jsx("div",{className:"ios-separator mx-4"}),(0,a.jsxs)("button",{onClick:s,className:"ios-list-item w-full flex items-center justify-between text-left",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-7 h-7 rounded-full bg-red-100 flex items-center justify-center",children:a.jsx(R.Z,{className:"w-4 h-4 text-red-600"})}),a.jsx("span",{className:"text-[17px] text-red-600 font-normal",children:"Sign Out"})]}),a.jsx(P.Z,{className:"w-5 h-5 text-gray-400"})]})]}),(0,a.jsxs)(x.mQ,{defaultValue:"active",className:"space-y-4",children:[a.jsx("div",{className:"ios-segment",children:(0,a.jsxs)(x.dr,{className:"w-full grid grid-cols-3 bg-transparent p-0 h-auto",children:[a.jsx(x.SP,{value:"active",className:"ios-segment-item data-[state=active]:ios-segment-item-active text-[15px]",children:"Active Ride"}),a.jsx(x.SP,{value:"available",className:"ios-segment-item data-[state=active]:ios-segment-item-active text-[15px]",children:"Available"}),a.jsx(x.SP,{value:"stats",className:"ios-segment-item data-[state=active]:ios-segment-item-active text-[15px]",children:"Stats"})]})}),a.jsx(x.nU,{value:"active",className:"mt-4",children:a.jsx(Q,{})}),a.jsx(x.nU,{value:"available",className:"mt-4",children:c?a.jsx(E,{}):a.jsx(n.Zb,{className:"ios-card",children:(0,a.jsxs)(n.aY,{className:"text-center py-12",children:[a.jsx("div",{className:"text-6xl mb-4",children:"\uD83D\uDE97"}),a.jsx("p",{className:"text-lg font-medium mb-2 text-gray-900",children:"You are currently offline"}),a.jsx("p",{className:"text-gray-600 mb-4 text-[15px]",children:"Turn on availability to start accepting rides"})]})})}),a.jsx(x.nU,{value:"stats",className:"mt-4",children:a.jsx(X,{})})]})]})]})}function ee({className:e,variant:s="default",animation:t="shimmer",...l}){return a.jsx("div",{className:(0,O.cn)("bg-muted/50 rounded-lg",{default:"h-4 w-full",card:"h-32 w-full rounded-2xl",text:"h-3 w-3/4",circle:"h-12 w-12 rounded-full",button:"h-12 w-full rounded-full"}[s],{pulse:"animate-pulse",shimmer:"loading-shimmer",none:""}[t],e),...l})}function es(){return(0,a.jsxs)("div",{className:"native-card p-4 space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx(ee,{variant:"circle",className:"h-10 w-10"}),(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[a.jsx(ee,{className:"h-4 w-1/3"}),a.jsx(ee,{className:"h-3 w-1/2"})]})]}),a.jsx(ee,{variant:"card",className:"h-24"}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(ee,{className:"h-3 w-full"}),a.jsx(ee,{className:"h-3 w-4/5"})]})]})}function et(){return(0,a.jsxs)("div",{className:"space-y-6",children:[a.jsx("div",{className:"native-card p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[a.jsx(ee,{variant:"circle",className:"h-16 w-16"}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(ee,{className:"h-5 w-32"}),a.jsx(ee,{className:"h-4 w-24"})]})]}),a.jsx(ee,{variant:"button",className:"h-10 w-24"})]})}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx(ee,{variant:"button",className:"h-10 w-24"}),a.jsx(ee,{variant:"button",className:"h-10 w-24"}),a.jsx(ee,{variant:"button",className:"h-10 w-24"})]}),a.jsx(es,{}),a.jsx(es,{})]})}function ea(){let{user:e,profile:s,loading:t}=(0,l.a)(),[i,d]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{d(!0)},[]),t||!i)?a.jsx("div",{className:"min-h-screen bg-[#1a1d1f] flex items-center justify-center p-4",children:a.jsx("div",{className:"w-full max-w-6xl",children:a.jsx(et,{})})}):e&&s?a.jsx("div",{className:"min-h-screen bg-[#F2F2F7]",children:"driver"===s.role?a.jsx(K,{}):a.jsx(D,{})}):a.jsx("div",{className:"min-h-screen bg-[#F2F2F7] flex items-center justify-center p-4",children:a.jsx(j,{})})}},4165:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>i,__esModule:()=>r,default:()=>c});var a=t(7536);let l=(0,a.createProxy)(String.raw`C:\Users\pc\drive\Bureau\codes\gitride\app\page.tsx`),{__esModule:r,$$typeof:i}=l,d=l.default,c=d}};var s=require("../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[991,817,688,725,153],()=>t(3356));module.exports=a})();